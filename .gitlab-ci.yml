default:
  image:
    name: "deemp/elibrary-ci:latest"
  before_script:
    - mkdir -p "$HOME/.config/nix"
    - echo 'experimental-features = nix-command flakes' > "$HOME/.config/nix/nix.conf"
    - mkdir -p "/etc/containers/"
    - echo '{"default":[{"type":"insecureAcceptAnything"}]}' > /etc/containers/policy.json
    - cd elibrary

stages:
  - lint

lint:
  stage: lint
  script:
    - poetry run flake8 elibrary
    - poetry run pylint elibrary
    - cd front && npx eslint .